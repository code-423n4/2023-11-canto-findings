# Possible division by zero 
Possible division by zero at

* [LinearBondingCurve.sol #35](https://github.com/code-423n4/2023-11-canto/blob/main/1155tech-contracts/src/bonding_curve/LinearBondingCurve.sol#L35)


# Validate ```id``` before accessing

## Instances
[Market.sol #134](https://github.com/code-423n4/2023-11-canto/blob/main/1155tech-contracts/src/Market.sol#L134)
[Market.sol #143](https://github.com/code-423n4/2023-11-canto/blob/main/1155tech-contracts/src/Market.sol#L143)
[Market.sol #195](https://github.com/code-423n4/2023-11-canto/blob/main/1155tech-contracts/src/Market.sol#L195)
## Mitigation
* Check if ```shareData[id]``` exists
* Check if ```bondingShare[id]``` exists


# Contracts are not using their OZ upgradeable counterpart
## Discription

The non-upgradeable standard version of OpenZeppelinâ€™s library, such as Ownable, Pausable, Address, Context, SafeERC20, ERC1967Upgrade etc, are inherited / used by both the proxy and the implementation contracts.

As a result, when attempting to use the upgrades plugin mentioned, errors will be raised when performing upgrades on the protocol

To prevent unexpected behavior, it would be safer to utilize the library contracts' upgradeable versions.


Link to a similar problem: https://code4rena.com/reports/2022-02-jpyc#l-03-contracts-are-not-using-their-oz-upgradeable-counterparts




##  Mitigation 

Where applicable, use the contracts from  `@openzeppelin/contracts-upgradeable`  instead of  `@openzeppelin/contracts`.

# Add constructor initializer in implementation contracts
## Description
The recommendation from OpenZeppelin (OZ) states that "by adding an empty constructor with the initializer modifier, the guidelines are now to make it impossible for anyone to run initialize on an implementation contract." Thus, upon deployment, the implementation contract is automatically initialized.

Because of the discovery of the UUPS vulnerability, similar behavior has also been included in the OZ Wizard: "In addition, we modified the code generated by the Wizard 19 to include a constructor that automatically initializes the implementation when deployed."

Moreover, this blocks any efforts to skip the implementation contract's initialization tx.

Rather than using an explicitly initialized variable, this change would require inheriting the Initializable contract.

Link to a similar problem: https://code4rena.com/reports/2022-02-jpyc#l-01-add-constructor-initializer-in-implementation-contracts

## Mitigation
Contracts need to have the constructor function shown below and inherit OZ's Initializable contract:
```javascript
import  "@openzeppelin/contracts-upgradeable/proxy/utils/Initializable.sol";
contract Example is 
	Initializable
	...
{
	...
	/// @custom:oz-upgrades-unsafe-allow constructor
	constructor() initializer {
		...
		...
	}
}
```


# Protocol Contracts are not pausable 
There is no way to pause; this is an unstable scenario where decentralization and security must be chosen. It makes sense to have a pause mechanism in place to protect user funds in the event that the project encounters difficulties.
## Mitigation
* Inherit the pausable contracts from OZ library, and implement them where needed, for example the most needed contract to be pausable is the ```Market.sol``` contract.
* Add ```notPaused``` modifier on some of the critical methods and functions like ```buy()```,  ```sell()```, ```changeBondingCurveAllowed()```,  and ```createShares()```


# 

# Unsafe subtraction 
## Instances
[Market.sol #182](https://github.com/code-423n4/2023-11-canto/blob/main/1155tech-contracts/src/Market.sol#L182)
[Market.sol #183](https://github.com/code-423n4/2023-11-canto/blob/main/1155tech-contracts/src/Market.sol#L183)
[Market.sol #184](https://github.com/code-423n4/2023-11-canto/blob/main/1155tech-contracts/src/Market.sol#L184)
[Market.sol #211](https://github.com/code-423n4/2023-11-canto/blob/main/1155tech-contracts/src/Market.sol#L211)
[Market.sol #212](https://github.com/code-423n4/2023-11-canto/blob/main/1155tech-contracts/src/Market.sol#L212)
[Market.sol #287](https://github.com/code-423n4/2023-11-canto/blob/main/1155tech-contracts/src/Market.sol#L287)
## Mitigation
* Require greater than
* Surround by unchecked to save gas

# Use scientific notation 
## Instances
[Market.sol #197](https://github.com/code-423n4/2023-11-canto/blob/main/1155tech-contracts/src/Market.sol#L197)

#  Incorrect event emittion
An event will be emitted in the following method, even if not action is taken by the function, as it is present in the if statement
## Instances
[Market.sol #269](https://github.com/code-423n4/2023-11-canto/blob/main/1155tech-contracts/src/Market.sol#L269)
```javascript
if (amount > 0) {
	SafeERC20.safeTransfer(token, msg.sender, amount);
}
emit HolderFeeClaimed(msg.sender, _id, amount);
```

## Mitigation
* Emit the event inside the if statement 
* Add else block statment and emit a different error/event in the other case

# Add comments to explain the assembly code 
Some comments are needed to explain the written assembly code.
## Instances
 [LinearBondingCurve.sol #42](https://github.com/code-423n4/2023-11-canto/blob/main/1155tech-contracts/src/bonding_curve/LinearBondingCurve.sol#L42)

